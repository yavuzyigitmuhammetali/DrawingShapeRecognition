# Camera Calibration Data

This directory stores camera calibration files generated by the calibration tool.

## Files

- `camera_calibration.yml` - Main calibration file containing:
  - Camera intrinsic matrix (fx, fy, cx, cy)
  - Distortion coefficients (k1, k2, p1, p2, k3, k4, k5, k6)
  - Image resolution used during calibration
  - Reprojection error and other metadata

## Workflow

### 1. Generate ChArUco Calibration Board

```bash
cd tools
python3 1_generate_charuco_calibration_board.py
```

This creates `charuco_calibration_board.pdf`. Print it at 100% scale on A4 paper.

### 2. Calibrate Camera

**Interactive (recommended):**
```bash
./build/calibrate_camera_charuco
```
The tool will scan and list all available cameras for you to select.

**Or specify camera explicitly:**
```bash
./build/calibrate_camera_charuco 0 calibration_data/camera_calibration.yml  # Camera 0
./build/calibrate_camera_charuco 1 calibration_data/camera1_calibration.yml  # Camera 1
```

**Instructions:**
- Select your camera (if multiple cameras available)
- Show the printed ChArUco board to the camera
- Press SPACE to capture frames from different angles and distances
- Capture at least 15-20 frames with good variety:
  - Different tilt angles (left, right, up, down)
  - Different distances (near, far, medium)
  - Cover all areas of the camera frame
- Press 'c' when ready to calibrate
- Lower reprojection error (<0.5 pixels) indicates better calibration

### 3. Test Calibration Accuracy

**Interactive (recommended):**
```bash
./build/test_calibration_accuracy
```

**Or specify camera and calibration file:**
```bash
./build/test_calibration_accuracy 0 calibration_data/camera_calibration.yml  # Camera 0
./build/test_calibration_accuracy 1 calibration_data/camera1_calibration.yml  # Camera 1
```

**Instructions:**
- Select the same camera you calibrated
- Use the test paper with ArUco markers (from `aruco_markers/generate_markers.py`)
- Draw a perfect circle in the center of the paper
- Show the paper to the camera
- The tool will:
  - Detect the 4 corner ArUco markers
  - Apply bird's-eye view transformation
  - Detect the circle
  - Measure two perpendicular diameters
  - Calculate the ratio (should be ~1.0 for perfect circle)

**Quality Indicators:**
- Ratio = 1.0000 ± 0.005 → Excellent
- Ratio = 1.0000 ± 0.01 → Very Good
- Ratio = 1.0000 ± 0.02 → Good
- Ratio = 1.0000 ± 0.05 → Acceptable
- Ratio > 1.05 or < 0.95 → Poor - Recalibrate

## Tips for Best Calibration

1. **Lighting:** Use even, bright lighting without shadows
2. **Board Quality:** Print at high quality, keep board flat
3. **Frame Variety:** Capture from many different angles/distances
4. **Stability:** Keep board still when capturing frames
5. **Coverage:** Ensure board fills different parts of camera view
6. **Multiple Cameras:** Create separate calibration files for each camera

## Using Calibration in Main Program

The main shape recognition program will load this calibration file to:
- Undistort camera images
- Apply accurate bird's-eye view transformation
- Improve shape detection accuracy
